@startuml
!include style.puml
skinparam ArrowFontStyle plain

title Sequence Diagram for EditPackageCommand (Simplified)

box Logic #C8C8FA
participant ":EditPackageCommand" as EditPackageCommand #3333C4
end box

box Model #F97181
participant ":Model" as Model #9D0012
participant ":InsuranceCatalog" as InsuranceCatalog #9D0012
participant ":UniquePackageList" as UniqueInsurancePackageList #9D0012
end box

[-> EditPackageCommand : execute(model)
activate EditPackageCommand

EditPackageCommand -> Model : getCatalog()
activate Model
Model --> EditPackageCommand : catalog
deactivate Model

EditPackageCommand -> InsuranceCatalog : getPackageList()
activate InsuranceCatalog

InsuranceCatalog -> UniqueInsurancePackageList : findPackage(name)
activate UniqueInsurancePackageList

UniqueInsurancePackageList --> InsuranceCatalog : list
deactivate UniqueInsurancePackageList


InsuranceCatalog --> EditPackageCommand : targetPackage
deactivate InsuranceCatalog

alt targetPackage == null
    <-- EditPackageCommand : CommandException (package not found)
else targetPackage != null

    EditPackageCommand -> "editedPackage:InsurancePackage" ** #00008B : createNewPackage(name, newDesc)
    activate "editedPackage:InsurancePackage"
    deactivate "editedPackage:InsurancePackage"

    EditPackageCommand -> Model : setPackage(oldPackage, editedPackage)
        activate Model

        Model -> InsuranceCatalog : setPackage(...)
        activate InsuranceCatalog

        InsuranceCatalog -> UniqueInsurancePackageList : setPackage(...)
        activate UniqueInsurancePackageList

        UniqueInsurancePackageList --> InsuranceCatalog
        deactivate UniqueInsurancePackageList

        InsuranceCatalog --> Model
        deactivate InsuranceCatalog

        Model --> EditPackageCommand
        deactivate Model

    <-- EditPackageCommand : CommandResult (Success)
end
deactivate EditPackageCommand
@enduml
